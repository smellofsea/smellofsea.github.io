---
layout:     post                    # 使用的布局（不需要改）
title:       网络层              # 标题 
subtitle:                           #副标题
date:       2020-11-12              # 时间
author:     smellofsea            # 作者
header-img:       #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    计算机网络
---

# 第四章 网络层
重点：  
（1）虚拟互连网络的概念。  
（2）IP地址与物理地址的关系。  
（3）传统的分类IP地址（包括子网掩码）和无分类域间路由选择CIDR。  
（4）路由选择协议的工作原理。
![Image](https://github.com/smellofsea/smellofsea.github.io/blob/master/Img/%E8%99%9A%E7%94%B5%E8%B7%AF%E5%92%8C%E6%95%B0%E6%8D%AE%E6%8A%A5.png)

### 网络层提供的两种服务
1、虚电路服务：类似于电信网，两台主机通信首先要建立连接，以预留双方通信的一切网络资源。然后双方沿着已建立的虚电路发送分组。  
2、数据报服务：网络层只提供简单灵活的、无连接的、尽可能努力交付的数据报服务。网络层不提供服务质量的承诺。
## 网络协议IP
与IP协议配套使用的三个协议：  
1、地址解析协议ARP  
2、网络控制报文协议  
3、网络组管理协议  
### 虚拟互联网络
将网络互相连接起来要使用一些中间设备：  
1、物理层使用的中间设备叫做**转发器**。  
2、数据链路层使用的中间设备叫做**网桥**或**桥接器**。  
3、网络层使用的中间设备叫**路由器**。  
4、在网络层以上使用的中间设备叫做**网关**。  
转发器或网桥仅仅是把网络扩大了，在网络层看依然是一个网络。网络互联一般指路由器进行网络互联和路由选择。  

**虚拟互连网络就是逻辑互连网络**：互相连接起来的各种物理网络的异构性客观存在，但是利用IP协议使这些网络在网络层上看起来像一个统一的网络。使用IP协议的虚拟互联网简称为IP网。

### IP地址及其表示方法
IP地址就是给互联网的每一台主机的每一个接口分配一个在全世界范围内是唯一的32位标识符.  
IP地址编址经过三个历史阶段：  
1、分类的IP地址。  
2、子网的划分。  
3、构成超网。  
#### 分类的IP地址
将IP地址分为A,B,C,D,E五类地址，每类由两个固定长度的**网络号**（表示主机所连接的网络）和**主机号**组成。  

A类地址可指派的网络号为126个。1、IP地址全为0表示“本网络”。2、网络号为127即01111111作为本地软件的环回测试用。每一个A类网络最大主机数是2^24-2.因为全0主机号表示“本主机”所连接的网络地址。全1表示该网段上所有的主机。  
B类地址的128.0.0.0是不指派的。主机号也要除去全0和全1.  
C类地址的网络号192.0.0.0不指派。主机号也是除去全0和全1.
D类地址用于多播。  
E类地址保留为以后用。  

IP地址的重要特点：  
1、IP地址管理机构只分配网络号，主机号由得到该网络号的单位自行分配。路由器仅根据目的主机所连接的网络号来转发分组。减少了路由表的存储空间和查找路由表的时间。  
2、IP地址是标志一台主机和一条链路的接口。  
3、用转发器或网桥连接起来的局域网仍为一个网络。不同网络号的局域网必须使用路由器进行互连。  
4、互联网同等的对待每一个IP地址。
#### IP地址与硬件地址


## IPv6
#### IPv6的改变
1、更大的地址空间。地址增大4倍，为128位。  
2、扩展的地址层次结构。由于地址空间大，可以划分更多的层次。  
3、灵活的首部地址。  
4、改进的选项。  
5、允许协议继续扩充。  
6、支持即插即用（即自动配置）  
7、支持资源的预分配。   
8、IPv6的首部改为8字节对齐。  

#### IPv6对首部的改变
1、取消了首部长度字段，首部长度固定。  
2、取消了服务类型字段。  
3、取消了总长度字段，改为有效载荷长度字段。  
4、取消了标识、标志和片偏移，这些功能包含在分片扩展首部。  
5、把TTL字段改为跳数限制字段。  
6、取消协议字段改用下一个首部字段。  
7、取消了检验和字段。加快了路由器处理数据报的速度。  
8、取消了选项字段，用扩展首部实现选项功能。  


#### IPv6的首部
只有8个字段数。  
0-3 版本 指明了协议的版本。  
4-11 通信量类。区分不同IPv6数据报的类别或优先级。  
12-31 流标号 对实时音频/视频数据的传送特别有用。  
有效载荷长度。 16位，指明除基本首部以外的字节数。最大为64KB。  
下一个首部 占8位。  
跳数限制 占8位  
源地址 占128位  
目的地址 占128位

#### IPv6的地址
三种基本类型：  
- 单播：传统的点对点通信。
- 多播：一对多的通信。
- 任播：任播的终点是一组计算机，但数据报只能交付其中的一个，通常是距离最近的一个。  
一个结点可以有多个单薄地址，其中的任一地址都可以当作到达该结点的目的地址。  
IPv6的特殊地址：
- 全零地址(::)只能为某台主机的源地址
- 环回地址(::1)
- 本地链路单播地址:有些网络使用TCP/IP协议但是并没有连接到网络上。  
- 全球单播地址：

### 从IPv4到IPv6的过渡。
#### 双栈协议
使一部分主机（或路由器）装有双栈协议：一个IPv4和一个IPv6.双栈主机即能和IPv4又能和IPv6系统通信。  
双栈主机通过DNS域名解析查询目的主机的地址。
这种方法会导致IPv6数据报首部的某些字段丢失。  
#### 隧道技术
IPv6数据报要进入IPv4网络时，把整个IPv6数据报封装为IPv4数据报的数据部分。

### 多播


