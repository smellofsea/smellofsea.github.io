---
layout:     post                    # 使用的布局（不需要改）
title:       网络链路层              # 标题 
subtitle:                           #副标题
date:       2020-10-22              # 时间
author:     smellofsea            # 作者
header-img:       #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    计算机网络
---
# 数据链路层
## 重点
- 点对点信道和广播信道的特点，以及这两种信道所使用协议的特点
- 数据链路层的三个问题：封装成帧、透明传输、差错检测
- 以太网MAC层的硬件地址
- 适配器、转发器、集线器、网桥、以太网交换机的作用以及使用场合

## 点对点信道
- **链路**：一个结点到相邻结点的一段物理线路（有线或无线），而中间没有其他的结点。（物理链路）
- **数据链路**:把实现控制数据传输的必要通信协议的硬件和软件加到链路上，构成数据链路。最常用的方法是使用网络适配器（硬件和软件）来实现这些协议。（逻辑链路）
### 点对点信道的数据链路层进行通信时的步骤
- 结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧
- 结点A把封装好的帧发送给结点B的数据链路层
- 结点B收到的帧无差错，从中提取IP数据报，送到网络层，有差错则抛弃
### 三个基本问题
#### 封装成帧
在一段数据的前后分别添加首部和尾部，构成帧。接收端根据首部和尾部判断开始和结束。但是每一中网络链路层协议都规定了所能传送的帧的数据部分长度的上限--**最大传送单元MTU**。
#### 透明传输
1、当传送的帧用文本文件组成的帧，数据部分不会和首尾标志一样，这样的传输就是透明传输。  
2、当传送的时非ASCLL码的文本文件，数据中的字节可能与首尾标志相同，数据链路层会错误的找到帧的边界。  
**解决方法**：  在数据中出现控制字符的前面添加一个**转义字符**。接收端的数据链路层在数据送往网络层之前删除这个转义字符。  
**透明**：某一个实际存在的事物看起来却好像不存在一样。

**比特差错**： 比特传输过程中出现1变成0或相反。  
**误码率**： 传输错误的比特与传输总数的比率。
#### 差错检错的方法：**循环冗余检测CRC**
1、发送端把数据规划成组，每组k个比特，假定为M。  
2、在数据后添加n位供差错检验用的n位冗余码，构成一个（k+n）个比特的帧发送出去。    
**n位检验码获得的方法** ：2^n乘于M，模2运算除于p（n+1位）余数为检验码。  为了进行检错添加的冗余码称为**帧检验序列FCS**。  
3、在接收端收到的数据以帧为单位进行CRC检验：得到的帧除于p，余数为0则认为没有差错，否则舍弃。
p的简单的表示方法P(x)=X^3+1,称为生成多项式。  
#### 传输差错
帧丢失、帧重复、帧失序。  

## 点对点协议PPP
### 设计PPP协议的要求
- 简单
- 封装成帧
- 透明性
- 多种网络层协议
- 多种类型链路
- 差错检测
- 检测连接状态
- 最大传送单元
- 网络层地址协商
- 数据压缩协议
### PPP协议的组成
1、一个将IP数据报封装到串行链路的方法。  
2、一个用来建立、配置和测试数据链路连接的链路控制协议（LCP）。  
3、一套网络控制协议（NCP）。
### PPP协议的帧格式
#### 各字段的意义
F(7E) 1:  标志字段（开始或结束）  
A(FF) 1:  地址字段（没有意义）  
C(03) 1:  控制字段 （没有意义）  
协议  2：  0X0021表示信息字段就是IP数据报，0xC021是PPP链路控制协议LCP的数据，0x8021表示网络层的控制数据。  
信息部分 ：不超过1500字节  
FCS  2  ：帧检验序列
F(7E) 1：标志字段（结束）  
#### 字节填充
当信息字段出现标志字符时，采取措施使比特组合不会出现。  
（PPP使用异步传输时转义字符为0x7D。）
#### 零比特填充
同步传输（逐字符的传送）时，使用零比特填充。  
**填充方法**：当出现5个连续的1立即填入一个0，接收端要删除。 
### PPP协议的工作状态
#### PPP链路的初始化
1、用户个人电脑接入ISP后，就建立了一条用户个人电脑到ISP的物理连接。  
2、用户个人电脑向ISP发送一系列链路控制协议LCP分组（PPP帧，配置请求帧），以便建立LCP连接，这些分组以及其响应选择了将要使用的一些PPP参数。链路的另一端可以发送几种响应：1、配置确定帧。2、配置否认帧。3、配置拒绝帧。
3、建立LCP链路，接着进入“鉴别”状态。只允许传送LCP协议的分组、鉴别协议的分组以及检测链路质量的分组。  
4、鉴别成功，进行网络配置，网络控制协议NCP给新接入的用户的个人电脑分配一个临时的IP地址。PPP协议两端的网络层可以运行不同的网络协议，但依然使用同一个PPP协议进行通信。
5、通信结束后，NCP释放网络层连接，收回分配的IP地址。LCP释放链路层连接。最后释放的时物理层的连接。  


## 使用广播信道的数据链路层
**局域网的特点**：网络为一个单位所有，地理范围和站点数目有限。  
**局域网的优点**：  
1、具有广播功能，从一个站点可以访问全网。局域网的之际可以共享网上的主机的硬件和软件资源。  
2、便于系统的扩展和逐渐演变，各设备的位置可灵活调节和改变。  
3、提高系统的可靠性、可用性和生存性。  
### 局域网按照网络拓扑分类
- 星形网：由于集线器的出现和双绞线的大量用于局域网，星形以太网得到广泛应用。
- 环形网
- 总线网：各站直接连在总线上。  
以太网几乎成为局域网的同义词。

**局域网的层次跨越了数据链路层和物理层**。
### 共享信道的方法
- 静态划分信道：频分复用、时分复用、码分复用等。但是不适合于局域网。
- 动态媒体接入控制（多点接入）：  
1、**随机接入**：所有用户可随机的发送信息。会发生碰撞，需要有解决的协议。  
2、**受控接入**：服从一定的控制发信息，典型的是探询和轮询。  
**以太网主要使用随机接入**。  

### 以太网的标准
局域网的数据链路层分为：  
1、逻辑链路控制LLC子层：作用已经消失。  
2、媒体接入控制MAC子层

  ### 适配器
- 计算机与外界局域网的连接是通过**通信适配器（网卡）** 进行的。
- 通信适配器上有处理器和存储器。  
- 适配器与局域网是通过电缆或双绞线 **串行传输** ，适配器与计算机是通过计算机I/O总线 **并行传输** 。  
- 适配器的一个主要功能就是进行数据串行和并行传输的转换。  
- 适配器在接受和发送帧时不使用计算机的CPU。计算机硬件地址-MAC地址就是适配器的ROM，软件地址-IP在计算机的存储器中。

## CSMA/CD协议
协议要点：发送前先监听，边发送边监听，一旦发现总线出现碰撞，就立即停止发送，然后按照退避算法等待一段时间后再发送。










